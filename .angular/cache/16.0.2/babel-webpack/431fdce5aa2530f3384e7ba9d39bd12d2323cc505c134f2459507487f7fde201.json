{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from \"@angular/core\";\nimport { map } from \"rxjs\";\nlet NewProduitComponent = class NewProduitComponent {\n  constructor(produitService, route, categoryService, formBuilder) {\n    this.produitService = produitService;\n    this.route = route;\n    this.categoryService = categoryService;\n    this.formBuilder = formBuilder;\n    this.photosTab = [];\n  }\n  ngOnInit() {\n    this.createForm = this.formBuilder.group({\n      ShortLibel: [null],\n      LongLibel: [null],\n      prxHt: [null]\n    });\n    // Récupérez l'ID de la catégorie depuis le service\n    this.currentCategoryId = this.categoryService.getCurrentCategoryId();\n    this.produitPreview$ = this.createForm.valueChanges.pipe(map(formvalue => ({\n      ...formvalue,\n      categorie: this.currentCategoryId,\n      photos: this.photosTab\n    })));\n    this.addPhotos = this.formBuilder.group({\n      photos0: [null],\n      photos1: [null],\n      photos2: [null],\n      photos3: [null],\n      photos4: [null],\n      photos5: [null]\n    });\n  }\n  addField(event) {\n    const currentButton = event.target;\n    const currentId = currentButton.id;\n    const index = parseInt(currentId.slice(8));\n    const srcActuel = this.createForm.value[`photos${index}`];\n    if (srcActuel && !this.photosTab.includes(srcActuel)) {\n      this.photosTab.push(srcActuel);\n      console.log(this.photosTab);\n    }\n    if (index > 5) {\n      return; // Limite maximale atteinte, ne pas ajouter de nouvel champ\n    }\n\n    const newId = `photos${index + 1}`;\n    const nextElement = document.getElementById(newId);\n    if (nextElement) {\n      nextElement.classList.toggle(\"toggle\");\n    }\n  }\n  onSubmitForm() {\n    this.produitService.createProduit(this.createForm.value, this.currentCategoryId).subscribe(response => {\n      console.log(response);\n      // Faites ce que vous voulez avec les données renvoyées\n    }, error => {\n      console.error(error);\n      // Gérez les erreurs ici\n    });\n  }\n};\n\nNewProduitComponent = __decorate([Component({\n  selector: \"app-new-produit\",\n  templateUrl: \"./new-produit.component.html\",\n  styleUrls: [\"./new-produit.component.scss\"]\n})], NewProduitComponent);\nexport { NewProduitComponent };\nfunction slugify(text) {\n  const normalizedText = text.replace(/[^a-zA-Z0-9\\s]/g, \"\").toLowerCase();\n  const slug = normalizedText.replace(/\\s+/g, \"-\");\n  return slug;\n}","map":{"version":3,"names":["Component","map","NewProduitComponent","constructor","produitService","route","categoryService","formBuilder","photosTab","ngOnInit","createForm","group","ShortLibel","LongLibel","prxHt","currentCategoryId","getCurrentCategoryId","produitPreview$","valueChanges","pipe","formvalue","categorie","photos","addPhotos","photos0","photos1","photos2","photos3","photos4","photos5","addField","event","currentButton","target","currentId","id","index","parseInt","slice","srcActuel","value","includes","push","console","log","newId","nextElement","document","getElementById","classList","toggle","onSubmitForm","createProduit","subscribe","response","error","__decorate","selector","templateUrl","styleUrls","slugify","text","normalizedText","replace","toLowerCase","slug"],"sources":["/home/diane/Documents/PROJET/WitchyDesktop/src/app/new-produit/new-produit.component.ts"],"sourcesContent":["import { Component, OnInit } from \"@angular/core\";\nimport { ProduitService } from \"../services/produits.services\";\nimport { FormBuilder, FormGroup } from \"@angular/forms\";\nimport { Observable, distinctUntilChanged, map } from \"rxjs\";\nimport { Produits } from \"../models/produits.model\";\nimport { ActivatedRoute } from \"@angular/router\";\nimport { CategorieService } from \"../services/categories.services\";\n\n@Component({\n  selector: \"app-new-produit\",\n  templateUrl: \"./new-produit.component.html\",\n  styleUrls: [\"./new-produit.component.scss\"],\n})\nexport class NewProduitComponent implements OnInit {\n  \n  createForm!: FormGroup;\n  \n  produitPreview$!: Observable<Produits>;\n  currentCategoryId!: number | null;\n  photosTab: string[] = [];\n \n  constructor(\n    private produitService: ProduitService,\n    private route: ActivatedRoute,\n    private categoryService: CategorieService,\n    private formBuilder: FormBuilder\n  ) {}\n\n  ngOnInit(): void {\n    this.createForm = this.formBuilder.group({\n      ShortLibel: [null],\n      LongLibel: [null],\n      prxHt: [null],\n  \n    });\n\n    // Récupérez l'ID de la catégorie depuis le service\n    this.currentCategoryId = this.categoryService.getCurrentCategoryId();\n\n    this.produitPreview$ = this.createForm.valueChanges.pipe(\n      map((formvalue) => ({\n        ...formvalue,\n        categorie: this.currentCategoryId,\n        photos: this.photosTab,\n      }))\n    );\n\n    this.addPhotos = this.formBuilder.group({\n          photos0: [null],\n      photos1: [null],\n      photos2: [null],\n      photos3: [null],\n      photos4: [null],\n      photos5: [null],\n    })\n  }\n\n  addField(event: Event): void {\n    const currentButton = event.target as HTMLButtonElement;\n    const currentId = currentButton.id;\n    const index = parseInt(currentId.slice(8));\n    const srcActuel = this.createForm.value[`photos${index}`];\n    if (srcActuel && !this.photosTab.includes(srcActuel)) {\n      this.photosTab.push(srcActuel);\n      console.log(this.photosTab);\n    }\n    if (index > 5) {\n      return; // Limite maximale atteinte, ne pas ajouter de nouvel champ\n    }\n    const newId = `photos${index + 1}`;\n    const nextElement = document.getElementById(newId);\n    if (nextElement) {\n      nextElement.classList.toggle(\"toggle\");\n    }\n  }\n  onSubmitForm(): void {\n    this.produitService\n      .createProduit(\n        this.createForm.value,\n        this.currentCategoryId,\n      )\n      .subscribe(\n        (response) => {\n          console.log(response);\n          // Faites ce que vous voulez avec les données renvoyées\n        },\n        (error) => {\n          console.error(error);\n          // Gérez les erreurs ici\n        }\n      );\n  } \n}\n\nfunction slugify(text: string): string {\n  const normalizedText = text.replace(/[^a-zA-Z0-9\\s]/g, \"\").toLowerCase();\n  const slug = normalizedText.replace(/\\s+/g, \"-\");\n\n  return slug;\n}\n"],"mappings":";AAAA,SAASA,SAAS,QAAgB,eAAe;AAGjD,SAA2CC,GAAG,QAAQ,MAAM;AAU5D,IAAaC,mBAAmB,GAAhC,MAAaA,mBAAmB;EAQ9BC,YACUC,cAA8B,EAC9BC,KAAqB,EACrBC,eAAiC,EACjCC,WAAwB;IAHxB,KAAAH,cAAc,GAAdA,cAAc;IACd,KAAAC,KAAK,GAALA,KAAK;IACL,KAAAC,eAAe,GAAfA,eAAe;IACf,KAAAC,WAAW,GAAXA,WAAW;IANrB,KAAAC,SAAS,GAAa,EAAE;EAOrB;EAEHC,QAAQA,CAAA;IACN,IAAI,CAACC,UAAU,GAAG,IAAI,CAACH,WAAW,CAACI,KAAK,CAAC;MACvCC,UAAU,EAAE,CAAC,IAAI,CAAC;MAClBC,SAAS,EAAE,CAAC,IAAI,CAAC;MACjBC,KAAK,EAAE,CAAC,IAAI;KAEb,CAAC;IAEF;IACA,IAAI,CAACC,iBAAiB,GAAG,IAAI,CAACT,eAAe,CAACU,oBAAoB,EAAE;IAEpE,IAAI,CAACC,eAAe,GAAG,IAAI,CAACP,UAAU,CAACQ,YAAY,CAACC,IAAI,CACtDlB,GAAG,CAAEmB,SAAS,KAAM;MAClB,GAAGA,SAAS;MACZC,SAAS,EAAE,IAAI,CAACN,iBAAiB;MACjCO,MAAM,EAAE,IAAI,CAACd;KACd,CAAC,CAAC,CACJ;IAED,IAAI,CAACe,SAAS,GAAG,IAAI,CAAChB,WAAW,CAACI,KAAK,CAAC;MAClCa,OAAO,EAAE,CAAC,IAAI,CAAC;MACnBC,OAAO,EAAE,CAAC,IAAI,CAAC;MACfC,OAAO,EAAE,CAAC,IAAI,CAAC;MACfC,OAAO,EAAE,CAAC,IAAI,CAAC;MACfC,OAAO,EAAE,CAAC,IAAI,CAAC;MACfC,OAAO,EAAE,CAAC,IAAI;KACf,CAAC;EACJ;EAEAC,QAAQA,CAACC,KAAY;IACnB,MAAMC,aAAa,GAAGD,KAAK,CAACE,MAA2B;IACvD,MAAMC,SAAS,GAAGF,aAAa,CAACG,EAAE;IAClC,MAAMC,KAAK,GAAGC,QAAQ,CAACH,SAAS,CAACI,KAAK,CAAC,CAAC,CAAC,CAAC;IAC1C,MAAMC,SAAS,GAAG,IAAI,CAAC7B,UAAU,CAAC8B,KAAK,CAAC,SAASJ,KAAK,EAAE,CAAC;IACzD,IAAIG,SAAS,IAAI,CAAC,IAAI,CAAC/B,SAAS,CAACiC,QAAQ,CAACF,SAAS,CAAC,EAAE;MACpD,IAAI,CAAC/B,SAAS,CAACkC,IAAI,CAACH,SAAS,CAAC;MAC9BI,OAAO,CAACC,GAAG,CAAC,IAAI,CAACpC,SAAS,CAAC;;IAE7B,IAAI4B,KAAK,GAAG,CAAC,EAAE;MACb,OAAO,CAAC;;;IAEV,MAAMS,KAAK,GAAG,SAAST,KAAK,GAAG,CAAC,EAAE;IAClC,MAAMU,WAAW,GAAGC,QAAQ,CAACC,cAAc,CAACH,KAAK,CAAC;IAClD,IAAIC,WAAW,EAAE;MACfA,WAAW,CAACG,SAAS,CAACC,MAAM,CAAC,QAAQ,CAAC;;EAE1C;EACAC,YAAYA,CAAA;IACV,IAAI,CAAC/C,cAAc,CAChBgD,aAAa,CACZ,IAAI,CAAC1C,UAAU,CAAC8B,KAAK,EACrB,IAAI,CAACzB,iBAAiB,CACvB,CACAsC,SAAS,CACPC,QAAQ,IAAI;MACXX,OAAO,CAACC,GAAG,CAACU,QAAQ,CAAC;MACrB;IACF,CAAC,EACAC,KAAK,IAAI;MACRZ,OAAO,CAACY,KAAK,CAACA,KAAK,CAAC;MACpB;IACF,CAAC,CACF;EACL;CACD;;AA/EYrD,mBAAmB,GAAAsD,UAAA,EAL/BxD,SAAS,CAAC;EACTyD,QAAQ,EAAE,iBAAiB;EAC3BC,WAAW,EAAE,8BAA8B;EAC3CC,SAAS,EAAE,CAAC,8BAA8B;CAC3C,CAAC,C,EACWzD,mBAAmB,CA+E/B;SA/EYA,mBAAmB;AAiFhC,SAAS0D,OAAOA,CAACC,IAAY;EAC3B,MAAMC,cAAc,GAAGD,IAAI,CAACE,OAAO,CAAC,iBAAiB,EAAE,EAAE,CAAC,CAACC,WAAW,EAAE;EACxE,MAAMC,IAAI,GAAGH,cAAc,CAACC,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC;EAEhD,OAAOE,IAAI;AACb"},"metadata":{},"sourceType":"module","externalDependencies":[]}