{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from \"@angular/core\";\nimport { map } from \"rxjs\";\nlet NewProduitComponent = class NewProduitComponent {\n  constructor(produitService, route, categoryService, formBuilder, Router) {\n    this.produitService = produitService;\n    this.route = route;\n    this.categoryService = categoryService;\n    this.formBuilder = formBuilder;\n    this.Router = Router;\n    this.photosTab = [];\n  }\n  ngOnInit() {\n    this.createForm = this.formBuilder.group({\n      ShortLibel: [null],\n      LongLibel: [null],\n      prxHt: [null]\n    });\n    // Récupérez l'ID de la catégorie depuis le service\n    this.currentCategoryId = this.categoryService.getCurrentCategoryId();\n    this.produitPreview$ = this.createForm.valueChanges.pipe(map(formvalue => ({\n      ...formvalue,\n      categorie: this.currentCategoryId,\n      photos: this.photosTab\n    })));\n    this.addPhotos = this.formBuilder.group({\n      photos0: [null],\n      photos1: [null],\n      photos2: [null],\n      photos3: [null],\n      photos4: [null],\n      photos5: [null]\n    });\n  }\n  addField(event) {\n    const currentButton = event.target;\n    const currentId = currentButton.id;\n    const index = parseInt(currentId.slice(8));\n    const srcActuel = this.addPhotos.value[`photos${index}`];\n    if (srcActuel && !this.photosTab.includes(srcActuel)) {\n      this.photosTab.push(srcActuel);\n      console.log(this.photosTab);\n    }\n    if (index > 5) {\n      return; // Limite maximale atteinte, ne pas ajouter de nouvel champ\n    }\n\n    const newId = `photos${index + 1}`;\n    const nextElement = document.getElementById(newId);\n    if (nextElement) {\n      nextElement.classList.toggle(\"toggle\");\n    }\n  }\n  arePhotosEmpty(formvalue) {\n    return !formvalue['photos0'] && !formvalue['photos1'] && !formvalue['photos2'] && !formvalue['photos3'] && !formvalue['photos4'];\n  }\n  onSubmitForm() {\n    this.produitService.createProduit(this.createForm.value, this.currentCategoryId).subscribe(response => {\n      // Appel addPhoto() ici\n      this.produitService.addPhoto(this.addPhotos.value).subscribe(response => {\n        // Faites ce que vous voulez avec les données renvoyées\n      }, error => {\n        console.error(error);\n      });\n    }, error => {\n      console.error(error);\n    });\n  }\n};\nNewProduitComponent = __decorate([Component({\n  selector: \"app-new-produit\",\n  templateUrl: \"./new-produit.component.html\",\n  styleUrls: [\"./new-produit.component.scss\"]\n})], NewProduitComponent);\nexport { NewProduitComponent };\nfunction slugify(text) {\n  const normalizedText = text.replace(/[^a-zA-Z0-9\\s]/g, \"\").toLowerCase();\n  const slug = normalizedText.replace(/\\s+/g, \"-\");\n  return slug;\n}","map":{"version":3,"names":["Component","map","NewProduitComponent","constructor","produitService","route","categoryService","formBuilder","Router","photosTab","ngOnInit","createForm","group","ShortLibel","LongLibel","prxHt","currentCategoryId","getCurrentCategoryId","produitPreview$","valueChanges","pipe","formvalue","categorie","photos","addPhotos","photos0","photos1","photos2","photos3","photos4","photos5","addField","event","currentButton","target","currentId","id","index","parseInt","slice","srcActuel","value","includes","push","console","log","newId","nextElement","document","getElementById","classList","toggle","arePhotosEmpty","onSubmitForm","createProduit","subscribe","response","addPhoto","error","__decorate","selector","templateUrl","styleUrls","slugify","text","normalizedText","replace","toLowerCase","slug"],"sources":["/home/diane/Documents/PROJET/WitchyDesktop/src/app/new-produit/new-produit.component.ts"],"sourcesContent":["import { Component, OnInit } from \"@angular/core\";\nimport { ProduitService } from \"../services/produits.services\";\nimport { FormBuilder, FormGroup } from \"@angular/forms\";\nimport { Observable, distinctUntilChanged, map } from \"rxjs\";\nimport { Produits } from \"../models/produits.model\";\nimport { ActivatedRoute } from \"@angular/router\";\nimport { CategorieService } from \"../services/categories.services\";\n\n@Component({\n  selector: \"app-new-produit\",\n  templateUrl: \"./new-produit.component.html\",\n  styleUrls: [\"./new-produit.component.scss\"],\n})\nexport class NewProduitComponent implements OnInit {\n  \n  createForm!: FormGroup;\n  addPhotos!:FormGroup;\n  produitPreview$!: Observable<Produits>;\n  currentCategoryId!: number | null;\n  photosTab: string[] = [];\n \n  constructor(\n    private produitService: ProduitService,\n    private route: ActivatedRoute,\n    private categoryService: CategorieService,\n    private formBuilder: FormBuilder,\n    private Router\n  ) {}\n\n  ngOnInit(): void {\n    this.createForm = this.formBuilder.group({\n      ShortLibel: [null],\n      LongLibel: [null],\n      prxHt: [null],\n  \n    });\n\n    // Récupérez l'ID de la catégorie depuis le service\n    this.currentCategoryId = this.categoryService.getCurrentCategoryId();\n    this.produitPreview$ = this.createForm.valueChanges.pipe(\n      map((formvalue) => ({\n        ...formvalue,\n        categorie: this.currentCategoryId,\n        photos: this.photosTab,\n      }))\n    );\n\n    this.addPhotos = this.formBuilder.group({\n      photos0: [null],\n      photos1: [null],\n      photos2: [null],\n      photos3: [null],\n      photos4: [null],\n      photos5: [null],\n    })\n  }\n\n  addField(event: Event): void {\n    const currentButton = event.target as HTMLButtonElement;\n    const currentId = currentButton.id;\n    const index = parseInt(currentId.slice(8));\n    const srcActuel = this.addPhotos.value[`photos${index}`];\n    if (srcActuel && !this.photosTab.includes(srcActuel)) {\n      this.photosTab.push(srcActuel);\n      console.log(this.photosTab);\n    }\n    if (index > 5) {\n      return; // Limite maximale atteinte, ne pas ajouter de nouvel champ\n    }\n    const newId = `photos${index + 1}`;\n    const nextElement = document.getElementById(newId);\n    if (nextElement) {\n      nextElement.classList.toggle(\"toggle\");\n    }\n  }\n\n\n  arePhotosEmpty(formvalue: { [key: string]: string }): boolean {\n    return (\n      !formvalue['photos0'] &&\n      !formvalue['photos1'] &&\n      !formvalue['photos2'] &&\n      !formvalue['photos3'] &&\n      !formvalue['photos4']\n    );\n  }\n\n onSubmitForm(): void {\n  this.produitService.createProduit(this.createForm.value, this.currentCategoryId).subscribe(\n    (response) => {\n      // Appel addPhoto() ici\n      this.produitService.addPhoto(this.addPhotos.value).subscribe(\n        (response) => {\n          \n          // Faites ce que vous voulez avec les données renvoyées\n        },\n        (error) => {\n          console.error(error);\n        }\n      );\n    },\n    (error) => {\n      console.error(error);\n    }\n  );\n}\n}\n\nfunction slugify(text: string): string {\n  const normalizedText = text.replace(/[^a-zA-Z0-9\\s]/g, \"\").toLowerCase();\n  const slug = normalizedText.replace(/\\s+/g, \"-\");\n\n  return slug;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}